# 쇼핑 기록 관리 시스템 (Shopping History)

## 개요

코스트코 등 대형 매장에서의 구매 내역을 체계적으로 관리하는 Flask 기반 웹 애플리케이션입니다. 
구매한 품목의 가격 변동을 추적하고, 매장별/날짜별 구매 기록을 효율적으로 관리할 수 있습니다.

### 주요 기능
- 📅 **날짜별 구매 기록 관리**: 구매 일자와 매장별로 구매 내역 정리
- 🏪 **매장 정보 관리**: 전국 코스트코 매장 정보 및 GPS 기반 가까운 매장 자동 선택
- 💰 **가격 추적**: 품목별 가격 변동 이력 및 최저/최고가 정보
- 📊 **연간 구매 통계**: 연간 총 구매 금액 집계
- 🔍 **품목 검색**: 품목코드 입력 시 자동완성 기능
- 📱 **모바일 최적화**: 모바일 브라우저 최적화된 디자인

### 기술 스택
- **Backend**: Python Flask
- **Database**: SQLite
- **Frontend**: HTML5, CSS3, JavaScript

## DB 초기화 절차

### 1. 데이터베이스 디렉토리 생성
```bash
mkdir -p instance
```

### 2. 스키마 생성
```bash
# SQLite3을 사용하여 스키마 적용
sqlite3 instance/shopping.db < schema.sql
```

### 3. 초기 데이터 삽입
```bash
# 기본 품목, 구매자, 매장 정보 삽입
sqlite3 instance/shopping.db < seed.sql
```

### 4. 데이터베이스 구조 확인
```bash
# 테이블 목록 확인
sqlite3 instance/shopping.db ".tables"

# 각 테이블 구조 확인
sqlite3 instance/shopping.db ".schema 품목"
sqlite3 instance/shopping.db ".schema 구매기록"
```

### 데이터베이스 테이블 구조
- **품목**: 품목 코드, 품목명, 규격 정보
- **구매**: 구매자 정보
- **매장**: 전국 코스트코 매장 정보 (25개 매장, GPS 좌표 포함)
- **구매기록**: 실제 구매 내역 (일자, 품목, 수량, 가격, 할인 등)

## 서비스 구동 절차

### 1. Python 환경 준비
```bash
# Python 3.7 이상 권장
python3 --version

# Flask 설치
pip install flask
```

### 2. 서비스 실행
```bash
# 개발 서버 실행
python3 app.py

# 또는 Flask 명령어 사용
export FLASK_APP=app.py
flask run
```

### 3. 접속 확인
```
http://localhost:5000
```

### 4. 프로덕션 배포 (선택사항)
```bash
# Gunicorn 등 WSGI 서버 사용 권장
pip install gunicorn
gunicorn -w 4 -b 0.0.0.0:5000 app:app
```

### 보안 설정
- **Reverse Proxy 지원**: nginx 등 뒤에서 운영 시 `X-Script-Name` 헤더 처리

## 페이지 URL 구성 및 사용법

### 📱 메인 화면들

#### 1. 구매 기록 메인 (`/purchase`)
- **기능**: 날짜별/매장별 구매 내역 요약 보기
- **표시 정보**: 구매일자, 매장명, 총 구매금액
- **연간 통계**: 최근 1년간 총 구매금액 표시
- **사용법**: 특정 날짜/매장 클릭 시 상세 내역으로 이동

#### 2. 가격 정보 메인 (`/price`)
- **기능**: 전체 품목의 가격 정보 한눈에 보기
- **표시 정보**: 품목명, 규격, 최신 구매일, 최저가/최고가
- **사용법**: 품목 클릭 시 가격 변동 이력 확인 가능

### 🛒 구매 기록 관리

#### 3. 새 구매 등록 (`/purchase/select`)
- **기능**: 새로운 구매 기록 등록을 위한 날짜/매장 선택
- **GPS 기능**: 현재 위치에서 가장 가까운 매장 자동 선택
- **기본값**: 오늘 날짜 자동 설정

#### 4. 구매 상세 내역 (`/purchase/list/<date>/<store_code>`)
- **기능**: 특정 날짜/매장의 구매 품목 상세 보기
- **표시 정보**: 품목명, 규격, 구매금액
- **사용법**: 품목 클릭 시 수정 가능, "+" 버튼으로 새 품목 추가

#### 5. 품목 등록/수정 (`/purchase/item/<date>/<store_code>/<item_id>`)
- **기능**: 개별 품목 정보 등록 및 수정
- **자동완성**: 품목코드 입력 시 품목명, 규격, 최근 가격 자동 입력
- **계산 기능**: 수량 × 가격 - 할인금액 = 구매금액 자동 계산
- **삭제 기능**: 기존 품목 삭제 가능

### 💰 가격 추적

#### 6. 품목별 가격 이력 (`/price/<item_code>`)
- **기능**: 특정 품목의 가격 변동 이력 상세 보기
- **표시 정보**: 구매일자, 매장명, 최종가격 (가격-할인금액)
- **정렬**: 최신 구매일 순으로 정렬

### 🔧 API 엔드포인트

#### 7. 품목 정보 API (`/api/item-name/<code>`)
- **기능**: 품목코드로 품목 정보 조회 (JSON)
- **응답**: 품목명, 규격, 최근 구매가격
- **용도**: JavaScript 자동완성 기능에서 활용

## 특별 기능

### 🎯 스마트 입력 도우미
- **품목코드 자동완성**: 코드 입력 시 품목명, 규격 자동 완성
- **계산기 기능**: 수량, 가격 입력 시 총액 자동 계산
- **GPS 매장 선택**: 현재 위치 기반 가장 가까운 매장 추천

### 📊 통계 및 분석
- **연간 구매 총계**: 최근 1년간 총 구매금액 자동 집계
- **가격 추이**: 품목별 최저가/최고가 비교
- **매장별 구매 패턴**: 매장별 구매 빈도 확인

### 🔒 보안 및 배포
- **Safari 전용 접근**: 특정 네트워크 환경에서만 사용 가능
- **Reverse Proxy 지원**: nginx 등과 연동 시 URL prefix 자동 처리
- **SQLite 기반**: 별도 DB 서버 불필요, 파일 기반 간단 배포

## 맺음말

이 쇼핑 기록 관리 시스템은 **파이썬의 단순함**과 **Flask의 유연성**을 바탕으로, 복잡한 구매 내역을 쉽고 직관적으로 관리할 수 있도록 설계되었습니다.

### 🎯 설계 철학
- **간결함**: 불필요한 기능 없이 핵심 기능에 집중
- **직관성**: 누구나 쉽게 사용할 수 있는 인터페이스
- **실용성**: 실제 쇼핑 패턴을 반영한 기능 구성
- **확장성**: 새로운 매장, 품목 쉽게 추가 가능

### 🚀 향후 개선 방향
- 품목별 구매 주기 분석
- 매장별 가격 비교 기능
- 구매 예산 관리 기능
- 모바일 앱 연동

**백성의 편의를 위해 만들어진 이 도구가, 일상의 작은 번거로움을 덜어주기를 바랍니다.**

---
*"기술은 복잡함을 감추고, 단순함을 드러내야 한다."*
